# used to pull private images from ghcr.io
apiVersion: v1
kind: Secret
metadata:
  name: ghcr-auth
  namespace: example
type: kubernetes.io/dockerconfigjson
stringData:
  .dockerconfigjson: |
    {
      "auths": {
        "ghcr.io": {
          "username": "Pandoks",
          "password": "${sst.GithubPersonalAccessToken}"
        }
      }
    }

---
# allows the default service account for the example namespace to pull private images from ghcr.io by default
# without needing to specify the imagePullSecrets field in the pod spec
apiVersion: v1
kind: ServiceAccount
metadata:
  name: default
  namespace: example
imagePullSecrets:
  - name: ghcr-auth

---
# used to terminate TLS at the ingress controller for the traffic flow: client -> cloudflare -- here -> k3s
apiVersion: v1
kind: Secret
metadata:
  name: cloudflare-origin-tls
  namespace: example
type: kubernetes.io/tls
stringData:
  tls.crt: |
    ${sst.HetznerOriginTlsCrt}
  tls.key: |
    ${sst.HetznerOriginTlsKey}
