apiVersion: helm.cattle.io/v1
kind: HelmChart
metadata:
  name: main-postgres-main-cluster
  namespace: kube-system
spec:
  chart: oci://${ImageRegistry}/charts/postgres
  version: 0.1.0
  targetNamespace: &namespace main
  createNamespace: true
  failurePolicy: abort
  plainHTTP: ${IsDev}
  set:
    db: main
    namespace: *namespace
    credentials.secret: postgres-main-creds
    backup.path: kubernetes/main/postgres
    backup.image: ${ImageRegistry}/pgbackrest:${ImageTag}
    patroni.image: ${ImageRegistry}/patroni:${ImageTag}
